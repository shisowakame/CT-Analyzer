<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>DICOM Web Viewer (Multi-Series)</title>
    <!-- FontAwesome CDN追加 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="main-container" style="display: flex; gap: 20px; align-items: flex-start;">
        <div class="left-panel">
            <h2>DICOM Web Viewer (Multi-Series)<i class="fa-solid fa-x-ray"></i> </h2>
            <div id="toolbar" style="display: flex; flex-direction: column; align-items: flex-start; gap: 4px;">
                <div class="toolbar-row1" style="display: flex; align-items: center; gap: 2px; width: 100%;">
                    <label class="toolbar-label-text">モード:</label>
                    <div style="display: flex; align-items: center; background: #e0e0e0; border-radius: 20px; padding: 2px; position: relative;">
                        <button id="sync-mode-btn" style="border: none; background: #4CAF50; color: white; padding: 6px 12px; border-radius: 18px; cursor: pointer; font-size: 12px; transition: all 0.3s;"><i class="fa-solid fa-link"></i> 同期</button>
                        <button id="indep-mode-btn" style="border: none; background: transparent; color: #666; padding: 6px 12px; border-radius: 18px; cursor: pointer; font-size: 12px; transition: all 0.3s;"><i class="fa-solid fa-unlink"></i> 独立</button>
                    </div>
                    <button id="reset-roi-btn" style="border: none; background: #f44336; color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 8px;"><i class="fa-solid fa-eraser"></i> ROI削除</button>
                    <span style="margin-left: 8px; font-size: 12px; color: #333;">諧調揃え:</span>
                    <div style="display: flex; align-items: center; background: #e0e0e0; border-radius: 20px; padding: 2px; margin-left: 4px;">
                        <button id="match-contrast-on-btn" style="border: none; background: transparent; color: #666; padding: 6px 12px; border-radius: 18px; cursor: pointer; font-size: 12px; transition: all 0.3s;">ON</button>
                        <button id="match-contrast-off-btn" style="border: none; background: #ff9800; color: white; padding: 6px 12px; border-radius: 18px; cursor: pointer; font-size: 12px; transition: all 0.3s;">OFF</button>
                    </div>
                    <button id="download-display-btn" style="border: none; background: #2196F3; color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 8px;"><i class="fa-solid fa-download"></i> 表示画像保存</button>
                    <button id="download-display-roi-btn" style="border: none; background: #2196F3; color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 8px;"><i class="fa-solid fa-download"></i> 表示画像保存(ROI含む)</button>
                    <!-- <button id="download-display-roi-btn" style="border: none; background: #9C27B0; color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 8px;"><i class="fa-solid fa-download"></i> 表示画像保存(ROI含む)</button> -->
                </div>
                <div class="toolbar-row2" style="display: flex; align-items: center; gap: 5px; width: 100%;">
                    <label class="toolbar-label-text">サイズ:</label>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <input type="number" id="roi-width" min="3" max="200" value="10" style="width: 30px;">
                        <span>×</span>
                        <input type="number" id="roi-height" min="3" max="200" value="10" style="width: 30px;">
                    </div>
                    <span> プリセット:</span>
                    <div style="display: flex; align-items: center; gap: 2px;">
                        <button class="preset" data-w="5" data-h="5">5×5</button>
                        <button class="preset" data-w="10" data-h="10">10×10</button>
                        <button class="preset" data-w="20" data-h="20">20×20</button>
                        <button class="preset" data-w="50" data-h="50">50×50</button>
                    </div>
                    <span style="margin-left: 8px;">ROI色:</span>
                    <input type="color" id="roi-color-picker" value="#ff0000" style="width: 40px; height: 30px; border: 2px solid #ccc; border-radius: 4px; cursor: pointer; margin-left: 4px;" title="ROI色を変更">
                </div>
            </div>
            <div id="grid">
                {series_blocks}
            </div>
            <div id="global-slider-block">
                <input type="range" id="global-slider" min="0" max="{global_max_idx}" value="0" />
                <span id="global-slice-label"><i class="fa-solid fa-layer-group"></i> Slice: 1/{global_max_idx_plus1}</span>
            </div>
        </div>
        <div class="right-panel">
            <div class="history-panel">
                <div class="history-header">
                    <h3><i class="fa-solid fa-clock-rotate-left"></i> ROI統計履歴</h3>
                    <div class="history-controls">
                        <button id="save-btn" class="save-btn"><i class="fa-solid fa-floppy-disk"></i> 保存</button>
                        <button id="reset-btn" class="reset-btn"><i class="fa-solid fa-trash"></i> リセット</button>
                        <button id="export-excel-btn" class="export-excel-btn"><i class="fa-solid fa-file-excel"></i> Excelエクスポート</button>
                    </div>
                </div>
                <div class="history-content">
                    <div id="history-table-block" class="history-table-block"></div>
                    <div id="history-avg-row-block"></div>
                </div>
                <div class="info-text"><i class="fa-solid fa-keyboard"></i> Ctrl+Sでも保存できます</div>
            </div>
        </div>
    </div>
    

    
    <script src="scripts.js"></script>
</body>
</html>